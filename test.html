<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script type="text/javascript">
$(function() {
  $('#btn').click(function(){

        var languageFrom = "ja";
        var languageTo = "en";

        var text = $('#text').text();

            PageMethods.GetAccessToken(OnSucceeded, OnFailed);
        });

        function OnSucceeded(result, usercontext, methodName) {

            window.mycallback = function (response) {
              $('#text2').val(response);
              alert(response);
            }

            var s = document.createElement("script");
            s.src = "http://api.microsofttranslator.com/V2/Ajax.svc/Translate?oncomplete=mycallback&appId=Transpeech " + encodeURIComponent(result.access_token) + "&from=" + languageFrom + "&to=" + languageTo + "&text=" + text;
            document.getElementsByTagName("head")[0].appendChild(s);
        }

        function OnFailed(error, userContext, methodName) {
            alert("Error");
        }
});
</script>
</head>
<body>
<input type="button" value="click" id="btn" />
<p id="text">こんにちは。</p>
<p id="text2"></p>
</body>
</html>
